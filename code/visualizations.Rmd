---
title: "Visualizations"
author: "Amrit Singh"
date: "2023-10-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

## load data

```{r}
.list <- lapply(list.files(here::here("results"), full.names = TRUE), function(rds){
  readRDS(rds)
})

res <- do.call(rbind, .list)
```

## overall performance by method

```{r}
res %>% 
  group_by(method) %>% 
  summarise(mean = mean(rank, na.rm=TRUE), sd = sd(rank, na.rm = TRUE)) %>% 
  ggplot(aes(x = mean, y = reorder(method, mean), fill = method)) +
  geom_bar(stat = "identity", position = "dodge") + ylab("Method + Database Annotation")
```

## overall performance by database

```{r}
res %>% 
  group_by(database) %>% 
  summarise(mean = mean(rank, na.rm=TRUE), sd = sd(rank, na.rm = TRUE)) %>% 
  ggplot(aes(x = mean, y = reorder(database, mean), fill = database)) +
  geom_errorbar(aes(xmin=mean-1, xmax=mean+sd), width=.2,
                 position=position_dodge(.9)) +
  geom_bar(stat = "identity", position = "dodge") + ylab("Method + Database Annotation")
```


## overall performance by method x database

```{r}
res %>% 
  group_by(method_db) %>% 
  summarise(mean = mean(rank, na.rm=TRUE), sd = sd(rank, na.rm = TRUE),
            db = unique(database)) %>% 
  ggplot(aes(x = mean, y = reorder(method_db, mean), fill = db)) +
  geom_errorbar(aes(xmin=mean-1, xmax=mean+sd), width=.2,
               position=position_dodge(.9)) +
  geom_bar(stat = "identity", position = "dodge") + ylab("Method + Database Annotation")
```


## overall performance by method x database x cytokine

```{r}

res %>% 
  group_by(method_db, cytokine) %>% 
  summarise(mean = mean(rank, na.rm=TRUE), sd = sd(rank, na.rm = TRUE),
            db = unique(database)) %>%  
  ggplot(aes(x = reorder(method_db, mean), y = mean, fill = db)) +
  geom_bar(stat = "identity", position = "dodge") + 
  geom_errorbar(aes(ymin=mean-1, ymax=mean+sd), width=.2,
             position=position_dodge(.9)) +
  ylab("Average rank") +
  xlab("Method + Database Annotation") +
  facet_wrap(~cytokine, ncol=1) + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))


```

